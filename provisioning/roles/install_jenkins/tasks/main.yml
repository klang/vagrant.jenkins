---

- name: jenkins-install | Add apt key
  apt_key: url=http://pkg.jenkins-ci.org/debian/jenkins-ci.org.key id=D50582E6

- name: jenkins-install | Add apt repo
  apt_repository: repo='deb http://pkg.jenkins-ci.org/debian binary/' update_cache=yes

- name: jenkins-install | Install jenkins
  apt: pkg=jenkins

#- name: jenkins-install | Setup passlib
#  apt: pkg=python-passlib
#  when: jenkins_proxy_auth

#- name: Create directory for jenkins backup
#  file: path=/opt/jenkins state=directory owner=jenkins group=nogroup
#  sudo: yes
#  sudo_user: jenkins

- name: Install cron to backup jenkins
  cron: state=present name="Backup Jenkins" minute=0 hour=2 job="tar zcvf /opt/jenkins/backup.tar.gz -C /opt/jenkins /var/lib/jenkins"

- name: Install Apache2 for jenkins
  apt: pkg=apache2
  notify: restart apache

